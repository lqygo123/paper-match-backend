(function(){var t={2275:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(2592),s=i(4768),o=(i(5034),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,null,null);e.Z=l.exports,a()}catch(c){a(c)}}))},8696:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(9093),s=i(1364),o=(i(2288),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,"6065a3a9",null);e.Z=l.exports,a()}catch(c){a(c)}}))},5900:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(2517),s=i(2782),o=(i(892),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,"c7eab676",null);e.Z=l.exports,a()}catch(c){a(c)}}))},8902:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(6193),s=i(8954),o=(i(3884),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,null,null);e.Z=l.exports,a()}catch(c){a(c)}}))},8572:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(4823),s=i(4171),o=(i(3759),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,"fc8c1b3e",null);e.Z=l.exports,a()}catch(c){a(c)}}))},7514:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(9943),s=i(6716),o=(i(1715),i(8763),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,"72c36c02",null);e.Z=l.exports,a()}catch(c){a(c)}}))},5881:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(5937),s=i(5192),o=(i(3733),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,"41180964",null);e.Z=l.exports,a()}catch(c){a(c)}}))},9847:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(7471),s=i(414),o=(i(5176),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,null,null);e.Z=l.exports,a()}catch(c){a(c)}}))},5816:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(7567),s=i(1776),o=(i(3501),i(1001)),r=t([s]);s=(r.then?(await r)():r)[0];var l=(0,o.Z)(s.Z,n.s,n.x,!1,null,"c6559668",null);e.Z=l.exports,a()}catch(c){a(c)}}))},5034:function(){},2288:function(){},892:function(){},3884:function(){},3759:function(){},1715:function(){},8763:function(){},3733:function(){},5176:function(){},3501:function(){},4768:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(9348),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},1364:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(2509),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},2782:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(8655),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},8954:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(9979),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},4171:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(2676),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},6716:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(6230),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},5192:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(2362),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},414:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(4735),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},1776:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(7290),s=t([n]);n=(s.then?(await s)():s)[0],e.Z=n.Z,a()}catch(o){a(o)}}))},9093:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});var a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"file-upload"}},[e("el-dialog",{attrs:{title:"编辑报告信息",visible:t.showMetaInfoModal},on:{"update:visible":function(e){t.showMetaInfoModal=e}}},[e("el-form",{attrs:{model:t.metaInfo,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"项目名称"}},[e("el-input",{model:{value:t.metaInfo.projectName,callback:function(e){t.$set(t.metaInfo,"projectName",e)},expression:"metaInfo.projectName"}})],1),e("el-form-item",{attrs:{label:"招标编号"}},[e("el-input",{model:{value:t.metaInfo.biddingNumber,callback:function(e){t.$set(t.metaInfo,"biddingNumber",e)},expression:"metaInfo.biddingNumber"}})],1),e("el-form-item",{attrs:{label:"招标人"}},[e("el-input",{model:{value:t.metaInfo.biddingCompany,callback:function(e){t.$set(t.metaInfo,"biddingCompany",e)},expression:"metaInfo.biddingCompany"}})],1),e("el-form-item",{attrs:{label:"参与公司"}},[e("el-input",{model:{value:t.metaInfo.participatingCompany,callback:function(e){t.$set(t.metaInfo,"participatingCompany",e)},expression:"metaInfo.participatingCompany"}})],1),e("el-form-item",{attrs:{label:"开标时间"}},[e("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",format:"yyyy-MM-dd"},model:{value:t.metaInfo.time,callback:function(e){t.$set(t.metaInfo,"time",e)},expression:"metaInfo.time"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.showMetaInfoModal=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleMetaInfoModalConfirm}},[t._v("确 定")])],1)],1),e("div",{staticClass:"file-upload-tab",attrs:{id:"mode-switch"}},[e("div",{staticClass:"file-upload-tab-item",class:{active:"digital"===t.mode},on:{click:function(e){t.mode="digital"}}},[e("span",[t._v("文件对比")])]),e("div",{staticClass:"file-upload-tab-item",class:{active:"ocr"===t.mode},on:{click:function(e){t.mode="ocr"}}},[e("span",[t._v("扫描件对比")])])]),e("div",{staticClass:"main-content"},[e("div",{staticClass:"file-upload-header"},[t._v("招标文件（可选）")]),e("div",{staticClass:"file-upload-desc"},[t._v(" 可选择上传一份招标文件参与查重，与招标文件相同内容不参与查重 ")]),e("div",{staticClass:"drop-zone",on:{drop:t.handleDropSkipFile,dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()},click:t.triggerSkipFileInput}},[t._m(0),t._m(1)]),t.skipFile?e("div",{staticClass:"file-list"},[e("div",{staticClass:"file-item"},[e("div",{staticClass:"file-content"},[t._v("招标文件")]),e("div",{staticClass:"file-name"},[t._v(t._s(t.skipFile.name))]),e("div",{staticClass:"file-content"},[t._v(t._s(t.skipFile.state))]),e("div",{staticClass:"file-content"},[e("el-button",{on:{click:function(e){return t.deleteSkipFile()}}},[t._v("删除")])],1)])]):t._e(),e("div",{staticClass:"file-upload-header"},[t._v("投标文件（必选）")]),e("div",{staticClass:"drop-zone",on:{drop:t.handleDrop,dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()},click:t.triggerFileInput}},[t._m(2),t._m(3)]),"digital"===t.mode?e("div",{staticClass:"extra-setting"},[e("el-tooltip",{attrs:{content:"是否开启对比文档中的图片对比，开启图片对比会显著降低查重运行速度",placement:"top"}},[e("el-switch",{attrs:{"active-color":"#13ce66","active-value":"1","inactive-value":"0"},model:{value:t.enableImageCompare,callback:function(e){t.enableImageCompare=e},expression:"enableImageCompare"}})],1),t._v(" 对比图片 ")],1):t._e(),t.files.length?e("div",{staticClass:"file-list"},t._l(t.files,(function(i,a){return e("div",{key:a,staticClass:"file-item"},[e("div",{staticClass:"file-content"},[t._v("投标文件")]),e("div",{staticClass:"file-name"},[t._v(t._s(i.name))]),e("div",{staticClass:"file-content"},[t._v(t._s(i.state))]),e("div",{staticClass:"file-content"},[e("el-button",{on:{click:function(e){return t.deleteFile(a)}}},[t._v("删除")])],1)])})),0):t._e(),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",multiple:""},on:{change:t.handleFile}}),e("input",{ref:"skipfileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:t.handleSkipFile}})]),e("div",{staticClass:"buttons-wrap"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleCompire}},[t._v("执行对比 ")])],1)],1)},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload-box left-box"},[e("div",{staticClass:"origin-file preview-div"},[e("img",{staticStyle:{top:"0px","margin-top":"0px",width:"72px",height:"72px"},attrs:{src:i(5989)}})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"unUploaded-container"},[e("div",{staticClass:"select-file-text left-select"},[t._v("点击或拖放招标文件到这里")]),e("div",{staticClass:"file-restriction"},[t._v(" 格式支持：单份 50M 以内 pdf 扫描件文档进行比对 ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload-box left-box"},[e("div",{staticClass:"origin-file preview-div"},[e("img",{staticStyle:{top:"0px","margin-top":"0px",width:"72px",height:"72px"},attrs:{src:i(5989)}})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"unUploaded-container"},[e("div",{staticClass:"select-file-text left-select"},[t._v("点击或拖放投标文件到这里")]),e("div",{staticClass:"file-restriction"},[t._v(" 格式支持：单份 50M 以内 pdf 扫描件文档进行比对 ")])])}]},4823:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});i(560);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-detail"},[e("div",{staticClass:"header-con"},[e("div",{staticClass:"header-desc"},[t._v(" "+t._s("edit"===t.mode?"编辑报告":"查重报告结果"))])]),e("div",{staticClass:"pdf-export-main-con"},[e("div",{staticClass:"report-header"},[e("div",{staticClass:"header-item"},[e("span",{staticClass:"label"},[t._v("项目名称：")]),"detail"===t.mode?e("span",{staticClass:"content"},[t._v(t._s(t.metaInfo.projectName||"—"))]):t._e(),"edit"===t.mode?e("el-input",{attrs:{placeholder:"请输入项目名称"},model:{value:t.metaInfo.projectName,callback:function(e){t.$set(t.metaInfo,"projectName",e)},expression:"metaInfo.projectName"}}):t._e()],1),e("div",{staticClass:"header-item"},[e("span",{staticClass:"label"},[t._v("招标编号：")]),"detail"===t.mode?e("span",{staticClass:"content"},[t._v(t._s(t.metaInfo.biddingNumber||"—"))]):t._e(),"edit"===t.mode?e("el-input",{attrs:{placeholder:"请输入招标编号"},model:{value:t.metaInfo.biddingNumber,callback:function(e){t.$set(t.metaInfo,"biddingNumber",e)},expression:"metaInfo.biddingNumber"}}):t._e()],1),e("div",{staticClass:"header-item"},[e("span",{staticClass:"label"},[t._v("招标人：")]),"detail"===t.mode?e("span",{staticClass:"content"},[t._v(t._s(t.metaInfo.biddingCompany||"—"))]):t._e(),"edit"===t.mode?e("el-input",{attrs:{placeholder:"请输入招标人"},model:{value:t.metaInfo.biddingCompany,callback:function(e){t.$set(t.metaInfo,"biddingCompany",e)},expression:"metaInfo.biddingCompany"}}):t._e()],1),e("div",{staticClass:"header-item"},[e("span",{staticClass:"label"},[t._v("参与公司：")]),"detail"===t.mode?e("span",{staticClass:"content"},[t._v(t._s(t.metaInfo.participatingCompany||"—"))]):t._e(),"edit"===t.mode?e("el-input",{attrs:{placeholder:"请输入参与公司"},model:{value:t.metaInfo.participatingCompany,callback:function(e){t.$set(t.metaInfo,"participatingCompany",e)},expression:"metaInfo.participatingCompany"}}):t._e()],1),e("div",{staticClass:"header-item"},[e("span",{staticClass:"label"},[t._v("开标时间：")]),"detail"===t.mode?e("span",{staticClass:"content"},[t._v(t._s(t.metaInfo.time||"—"))]):t._e(),"edit"===t.mode?e("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",format:"yyyy-MM-dd"},model:{value:t.metaInfo.time,callback:function(e){t.$set(t.metaInfo,"time",e)},expression:"metaInfo.time"}}):t._e()],1),e("div",{staticClass:"header-item"},[e("span",{staticClass:"label"},[t._v("提交时间：")]),e("span",{staticClass:"content"},[t._v(t._s(t.reportTime.substring(0,10)))])])]),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.results,border:""}},[e("el-table-column",{attrs:{align:"center",label:"编号",width:"50"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v(t._s(i.$index+1))])]}}])}),e("el-table-column",{attrs:{align:"center",prop:"biddingFileName",label:"招标公司"}}),e("el-table-column",{attrs:{align:"center",prop:"targetFileName",label:"对比公司"}}),e("el-table-column",{attrs:{align:"center",prop:"repetitionRate",label:"重复率"}}),e("el-table-column",{attrs:{align:"center",prop:"sameImage",label:"图片相似(张)"}}),e("el-table-column",{attrs:{align:"center",prop:"sameSentence",label:"相似句子(条)"}}),t.showPreview?e("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handleResultClick(i.row)}}},[t._v("查看")])]}}],null,!1,3805513506)}):t._e()],1)],1),e("div",{staticClass:"bottom-con"},[e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.$router.push("/report-list")}}},[t._v("返回")]),"detail"===t.mode?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleEdit}},[t._v("编辑")]):t._e(),"detail"===t.mode?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.exportPdf}},[t._v("导出报告")]):t._e(),"edit"===t.mode?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleSave}},[t._v("保存")]):t._e()],1)])},n=[]},5937:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});i(560);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"task-list-page"},[e("div",{staticClass:"task-list-header"},[t._v("查重进度")]),e("div",{staticClass:"task-list"},[t.groupedList.length?e("div",{staticClass:"task-list-item bold"},[e("div",{staticClass:"task-list-item-name"},[t._v("项目名称")]),e("div",{staticClass:"task-list-item"},[t._v("创建者")]),e("div",{staticClass:"task-list-item"},[t._v("比对状态")]),e("div",{staticClass:"task-list-item"},[t._v("上传时间")]),e("div",{staticClass:"task-list-item"},[t._v("操作")])]):e("el-empty",{staticClass:"no-task"},[e("el-link",{attrs:{type:"primary"},on:{click:()=>{t.$router.push("/report-list")}}},[t._v("点击查看最新报告")])],1),t._l(t.groupedList,(function(i){return e("div",{key:i.batchId+Math.random(),staticClass:"task-list-item"},[e("div",{staticClass:"task-list-item-name"},[t._v(t._s(i.projectName))]),e("div",{staticClass:"task-list-item"},[t._v(t._s("admin"===i.creator.role?"管理员":i.creator.name||"-"))]),e("div",{staticClass:"task-list-item"},[t._v(t._s(i.total-i.waitting-i.running)+"/"+t._s(i.total))]),e("div",{staticClass:"task-list-item"},[t._v(t._s(i.createAt))]),e("div",{staticClass:"task-list-item"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.cancelTask(i.batchId)}}},[t._v("取消")])],1)])}))],2)])},n=[]},2751:function(t){function e(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}e.keys=function(){return[]},e.resolve=e,e.id=2751,t.exports=e},7849:function(t,e,i){"use strict";i.d(e,{y:function(){return n}});i(8858),i(1318),i(3228);const a=new URL(location.href),n=a.origin},9348:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(5900),s=t([n]);n=(s.then?(await s)():s)[0],e.Z={name:"App",components:{Sidebar:n.Z},data(){return{showSidebar:"login"!==this.$route.name}},mounted(){console.log("mounted",this.$route),this.showSidebar=!("login"===this.$route.name||"pdf-preview"===this.$route.name)},watch:{$route(t){console.log("watch $route",t),this.showSidebar=!("login"===t.name||"pdf-preview"===t.name)}},errorCaptured(t,e,i){return console.error(t,i),!1}},a()}catch(o){a(o)}}))},2509:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{i(560);var n=i(3219),s=t([n]);n=(s.then?(await s)():s)[0],e.Z={name:"FileUpload",data(){return{mode:"digital",files:[],skipFile:null,compireResults:[],isCompire:!1,showMetaInfoModal:!1,enableImageCompare:!1,metaInfo:{projectName:"",biddingNumber:"",biddingCompany:"",participatingCompany:"",time:""}}},watch:{files:{handler(){console.log(this.files)},deep:!0}},methods:{async handleMetaInfoModalConfirm(){this.showMetaInfoModal=!1;const t=[];try{for(let e=0;e<this.files.length;e++)for(let i=0;i<this.files.length;i++)e!==i&&t.push({biddingFileId:this.files[e].fileId,targetFileId:this.files[i].fileId,skipFileId:this.skipFile&&this.skipFile.fileId,biddingFileName:this.files[e].name,targetFileName:this.files[i].name,enableImageCompare:"1"===this.enableImageCompare,mode:this.mode});console.log("createBatchDuplicate",t,this.metaInfo);await(0,n.AH)(t,this.metaInfo);this.$message("队列创建成功，开始对比，生成结果需要一段时间，请耐心等待...."),this.$router.push({path:"/task-list"})}catch(e){console.log(e),this.isCompire=!1,this.$message.error("对比失败请打开调试控制台查看具体报错信息")}},validateFiles(t){const e=["application/pdf"];console.log(t);const i=t.filter((t=>e.includes(t.type))),a=t.filter((t=>!e.includes(t.type)));return a.length&&alert("仅支持 pdf 格式的文件"),i},handleDrop(t){t.preventDefault();const e=this.validateFiles(Array.from(t.dataTransfer.files));e.length&&(this.files=[...this.files,...e]),e.forEach((t=>{this.uploadFile(t)}))},handleDropSkipFile(t){t.preventDefault();const e=this.validateFiles(Array.from(t.dataTransfer.files));e.length&&(this.skipFile=e[0]),this.skipFile&&this.uploadSkipFile()},handleFile(t){const e=this.validateFiles(Array.from(t.target.files));e.length&&(this.files=[...this.files,...e]),e.forEach((t=>{this.uploadFile(t)}))},handleSkipFile(t){const e=this.validateFiles(Array.from(t.target.files));e.length&&(this.skipFile=e[0]),this.skipFile&&this.uploadSkipFile()},triggerFileInput(){this.$refs.fileInput.click()},triggerSkipFileInput(){this.$refs.skipfileInput.click()},deleteFile(t){this.files.splice(t,1)},async uploadFile(t){const e=new FormData;e.append("file",t,encodeURIComponent(t.name)),t.state="上传中",this.files=[...this.files];try{const i=await(0,n.cT)(e,(e=>{console.log(t.name,e)}));t.state="上传成功",t.fileId=i.data._id}catch(i){t.state="上传失败"}this.files=[...this.files]},async uploadSkipFile(){const t=new FormData;t.append("file",this.skipFile,encodeURIComponent(this.skipFile.name)),this.skipFile.state="上传中";try{const e=await(0,n.cT)(t,(t=>{console.log(this.skipFile.name,t)}));this.skipFile.state="上传成功",this.skipFile.fileId=e.data._id,this.skipFile={...this.skipFile,name:this.skipFile.name,state:"上传成功",fileId:e.data._id}}catch(e){this.skipFile={...this.skipFile,name:this.skipFile.name,state:"上传失败"}}},deleteSkipFile(){this.skipFile=null},async handleCompire(){this.files.some((t=>"上传中"===t.state))?this.$message.error("有文件正在上传中，请等待上传完成"):this.files.length<2?this.$message.error("请至少上传两个文件"):this.showMetaInfoModal=!0},async handleGenerateReport(){const t=await(0,n.Zn)(this.compireResults.map((t=>t._id)));console.log("createReport res",t),this.$router.push({path:"/report-detail",query:{id:t.data._id,mode:"edit"}})},async execCompire(t,e,i){const a={biddingFileId:t,targetFileId:e,enableImageCompare:this.enableImageCompare,mode:this.mode};i&&(a.skipFileId=i),console.log("execCompire",a);const s=await(0,n.Rf)(a);return s.data}}},a()}catch(o){a(o)}}))},8655:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{i(560);var n=i(3219),s=t([n]);n=(s.then?(await s)():s)[0],e.Z={name:"Sidebar",components:{},data(){return{activeIndex:"/file-upload"}},mounted(){},watch:{$route(t){this.activeIndex=t.path}},methods:{handleLogout(){this.$confirm("确认退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,n.kS)(),this.$router.push("/login")}))},handleSelect(t){this.activeIndex=t,this.$router.push(t)}}},a()}catch(o){a(o)}}))},9979:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(2998),s=i(2269),o=i.n(s),r=i(8914),l=i(7849),c=i(3219),d=t([n,c]);[n,c]=d.then?(await d)():d;const u=(t,e,i)=>{const[a,n,s,o]=t;return a.length?[a[0]*i,a[1]*i,s[0]*i,s[1]*i]:[a*i,n*i,s*i,o*i]};let p;e.Z={data(){return{domain:l.y,mode:this.$route.query.mode,compireId:this.$route.query.compireId,factor:1,leftWidth:.3*document.documentElement.clientWidth,highlightedBlock:{},rendedPages:{},MockMatchRes:[],ocrPages:[],textRepetitionCount:0,compireResult:{abstract:{}},showPdf2:!1,ifPdf2Loaded:!1,pdf2HightedBlock:{},pdf2HightlightBlocks:[],pdf2RendedPages:{},pdf2ocrPages:[]}},async mounted(){console.log("this.$route",this.$route);const t=await(0,c.DH)(this.compireId),e=t;this.mode=e.data.mode,"ocr"===this.mode?this.factor=.4:this.factor=1,console.log("compireResult",e.data),console.log("compireResult detail",e.detail),this.compireResult=e.data,this.ocrPages=e.detail.pdf1Pages||[],this.pdf2ocrPages=e.detail.pdf2Pages||[];let i=e.detail.textRepetitions||e.detail.ocrRepetitions||[];e.detail.imageRepetitions&&e.detail.imageRepetitions.length&&(i=i.concat(e.detail.imageRepetitions)),i.forEach(((t,e)=>{t.index=e})),console.log("matchReslist",i),this.MockMatchRes=i,this.loadPdf(`${l.y}/api/v1/file/${this.compireResult.biddingFileId}`)},methods:{async loadPdf(t){let e;"ocr"===this.mode?e=this.ocrPages.length:(this.$loading({lock:!0,text:"正在加载中"}),n.Tu.workerSrc=i(9690),this.pdfDocument=await n.Me(t).promise,this.$loading().close(),e=this.pdfDocument.numPages);for(let i=1;i<=e;i++){const t=document.createElement("div");t.className="pdf-page",t.dataset.pageNum=i;const e=document.createElement("canvas");e.dataset.pageNum=i,this.$refs.pdfContainer.appendChild(t),t.appendChild(e)}const a=new IntersectionObserver((t=>{t.forEach((t=>{t.intersectionRatio>.3&&(this.renderPage(parseInt(t.target.dataset.pageNum),t.target),this.renderHighlightBlocks(parseInt(t.target.dataset.pageNum),t.target))}))}),{threshold:.3}),s=this.$refs.pdfContainer.querySelectorAll("canvas");s.forEach((t=>a.observe(t)))},async loadPdf2(t){let e;"ocr"===this.mode?(e=this.pdf2ocrPages.length,await new Promise(((t,e)=>{setTimeout((()=>{t()}),100)}))):(this.$loading({lock:!0,text:"正在加载中"}),p=await n.Me(t).promise,this.$loading().close(),e=p.numPages);for(let n=1;n<=e;n++){const t=document.createElement("div");t.className="pdf-page",t.dataset.pageNum=n;const e=document.createElement("canvas");e.dataset.pageNum=n,this.$refs.pdf2Container.appendChild(t),t.appendChild(e)}const i=new IntersectionObserver((t=>{t.forEach((t=>{t.intersectionRatio>.3&&(this.renderPage2(parseInt(t.target.dataset.pageNum),t.target),this.renderHighlightBlocks2(parseInt(t.target.dataset.pageNum),t.target))}))}),{threshold:.3}),a=this.$refs.pdf2Container.querySelectorAll("canvas");a.forEach((t=>i.observe(t)))},async renderPage2(t,e){if(!e.isRendered&&e)if(e.isRendered=!0,"ocr"===this.mode){const i=this.pdf2ocrPages[t-1],a={width:i.width*this.factor,height:i.height*this.factor},n=e.getContext("2d");e.height=a.height,e.width=a.width;const s=new Image;s.src=`${l.y}${i.src}`,s.onload=function(){n.drawImage(s,0,0,a.width,a.height)}}else{const i=await p.getPage(t),a=i.getViewport({scale:1}),n=e.getContext("2d");e.height=a.height,e.width=a.width,i.render({canvasContext:n,viewport:a}).promise}},getHighlightBlocks2(t){const e=this.MockMatchRes.filter((e=>e.pdf2Page===t)),i={};return e.forEach((t=>{const e=`${t.pdf2Page}-${t.pdf2BlockIdx}`;i[e]||(i[e]=t)})),Object.values(i)},renderHighlightBlocks2(t,e){if(e.isRenderHighlitBlocks)return;e.isRenderHighlitBlocks=!0;const i=this.getHighlightBlocks2(t-1),a=e.parentNode;console.log("renderHighlightBlocks2 blocks",t,i,a),i.forEach((t=>{const{pdf2coord:e}=t;if(!e)return;let[i,n,s,o]=u(e,a.clientHeight,this.factor);const r=s-i,l=o-n,c=document.createElement("div");c.className="highlight-block",c.style.position="absolute",c.style.left=`${i}px`,this.mode,c.style.top=`${n}px`,c.style.width=`${r}px`,c.style.height=`${l}px`,c.style.backgroundColor="rgba(255, 0, 0, 0.2)",c.dataset.id=t.id,c.dataset.index=t.index+1,c.dataset.blockIdx=`${t.type}-${t.pdf2Page}-${t.pdf2BlockIdx}`,c.addEventListener("click",(async()=>{console.log("hight block click",t.id),console.log("hight block click",JSON.stringify(t)),this.handleResItemClick(t);const e=window.document.querySelector(`.res-list > [data-id="${t.id}"]`);e.scrollIntoView(!0)})),console.log("renderHighlightBlocks2 div",c),a.appendChild(c)}))},handleShowPdf2(){this.showPdf2=!this.showPdf2,this.showPdf2&&this.loadPdf2(`${l.y}/api/v1/file/${this.compireResult.targetFileId}`)},async setCanvasSize(t,e){if("ocr"===this.mode){const i=this.ocrPages[t-1],a={width:i.width,height:i.height};e.height=a.height*this.factor,e.width=a.width*this.factor}else{const i=await this.pdfDocument.getPage(t),a=i.getViewport({scale:1});e.height=a.height*this.factor,e.width=a.width*this.factor}},getHighlightBlocks(t){const e=this.MockMatchRes.filter((e=>e.pdf1Page===t)),i={};return e.forEach((t=>{const e=`${t.pdf1Page}-${t.pdf1BlockIdx}`;i[e]||(i[e]=t)})),Object.values(i)},renderHighlightBlocks(t,e){if(e.isRenderHighlitBlocks)return;e.isRenderHighlitBlocks=!0;const i=this.getHighlightBlocks(t-1),a=e.parentNode;i.forEach((t=>{const{pdf1coord:e}=t;if(!e)return;let[i,n,s,o]=u(e,a.clientHeight,this.factor);const r=s-i,l=o-n,c=document.createElement("div");c.className="highlight-block",c.style.position="absolute",c.style.left=`${i}px`,this.mode,c.style.top=`${n}px`,c.style.width=`${r}px`,c.style.height=`${l}px`,c.style.backgroundColor="rgba(255, 0, 0, 0.2)",c.dataset.id=t.id,c.dataset.index=t.index+1,c.dataset.blockIdx=`${t.type}-${t.pdf1Page}-${t.pdf1BlockIdx}`,c.addEventListener("click",(async()=>{console.log("hight block click",t.id),console.log("hight block click",JSON.stringify(t)),this.handleResItemClick(t);const e=window.document.querySelector(`.res-list > [data-id="${t.id}"]`);e.scrollIntoView(!0)})),a.appendChild(c)}))},async renderPage(t,e){if(!e.isRendered&&e)if(e.isRendered=!0,"ocr"===this.mode){const i=this.ocrPages[t-1],a={width:i.width*this.factor,height:i.height*this.factor},n=e.getContext("2d");e.height=a.height,e.width=a.width;const s=new Image;s.src=`${l.y}${i.src}`,s.onload=function(){n.drawImage(s,0,0,a.width,a.height)}}else{const i=await this.pdfDocument.getPage(t),a=i.getViewport({scale:1}),n=e.getContext("2d");e.height=a.height,e.width=a.width,await i.render({canvasContext:n,viewport:a}).promise}},scrollToTargetPage(t,e){console.log("scrollToTargetPage",t,e);const i=this.$refs.pdfContainer.querySelector(`.pdfContainer > :nth-child(${t+1})`);if(i.scrollIntoView(!0),!this.showPdf2)return;const a=this.$refs.pdf2Container.querySelector(`.pdfContainer > :nth-child(${e+1})`);a&&a.scrollIntoView(!0)},onScroll(t){console.log(`Scrolled to page ${t}`),console.log(this.MockMatchRes[t-1]);const e=window.document.querySelector(`.res-list > :nth-child(${t})`);e.scrollIntoView(!0)},handleResItemClick(t){console.log("handleResItemClick",t);const e=()=>{if(this.highlightedBlock){const t=this.$refs.pdfContainer.querySelector(`.highlight-block[data-block-idx="${this.highlightedBlock.type}-${this.highlightedBlock.pdf1Page}-${this.highlightedBlock.pdf1BlockIdx}"]`);t&&(t.style.backgroundColor="rgba(255, 0, 0, 0.2)")}if(this.$refs.pdf2Container&&this.pdf2HightedBlock){const t=this.$refs.pdf2Container.querySelector(`.highlight-block[data-block-idx="${this.pdf2HightedBlock.type}-${this.pdf2HightedBlock.pdf2Page}-${this.pdf2HightedBlock.pdf2BlockIdx}"]`);t&&(t.style.backgroundColor="rgba(255, 0, 0, 0.2)")}this.highlightedBlock=t,this.pdf2HightedBlock=t;const e=this.$refs.pdfContainer.querySelector(`.highlight-block[data-block-idx="${this.highlightedBlock.type}-${this.highlightedBlock.pdf1Page}-${this.highlightedBlock.pdf1BlockIdx}"]`);if(e&&(e.style.backgroundColor="rgba(255, 255, 0, 0.5)"),this.$refs.pdf2Container){const t=this.$refs.pdf2Container.querySelector(`.highlight-block[data-block-idx="${this.pdf2HightedBlock.type}-${this.pdf2HightedBlock.pdf2Page}-${this.pdf2HightedBlock.pdf2BlockIdx}"]`);t&&(t.style.backgroundColor="rgba(255, 255, 0, 0.5)")}},i=t.pdf1Page,a=t.pdf2Page;this.scrollToTargetPage(i,a),setTimeout((()=>{e()}),300)},async handleExportPdf(){this.$message.info("正在初始化导出，请稍后");const t=this.$refs.pdfContainer.querySelectorAll(".pdf-page");for(let i=0;i<t.length;i++){const e=t[i];e.firstChild.isRendered||(await this.renderPage(i+1,e.firstChild),await this.renderHighlightBlocks(i+1,e.firstChild))}const e=new r.ZP("p","mm","a4");for(let i=0;i<t.length;i++){this.$message.info(`正在导出第 ${i} 页`);const a=t[i],n=await o()(a,{scale:1,useCORS:!0,allowTaint:!0,logging:!0}),s=n.toDataURL("image/png"),r=e.getImageProperties(s),l=e.internal.pageSize.getWidth(),c=r.height*l/r.width;e.addImage(s,"PNG",0,0,l,c),e.addPage()}e.save("download.pdf")}}},a()}catch(u){a(u)}}))},2676:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{i(560);var n=i(3219),s=i(2269),o=i.n(s),r=i(8914),l=t([n]);n=(l.then?(await l)():l)[0],e.Z={name:"ReportDetail",components:{},data(){return{id:"",mode:"detail",showPreview:!0,metaInfo:{projectName:"",biddingNumber:"",biddingCompany:"",participatingCompany:"",time:""},reportTime:"",results:[]}},mounted(){console.log(this.$route.query);const{id:t,mode:e}=this.$route.query;this.mode=e||"detail",this.id=t,this.getReportDetail(t)},methods:{async getReportDetail(t){const e=await(0,n.gp)(t);console.log("getReportDetail",e);const i=await(0,n.VB)(e.data.results);this.reportTime=e.data.reportTime,this.metaInfo=e.data.metaInfo||{projectName:"",biddingNumber:"",biddingCompany:"",participatingCompany:"",time:""},console.log("getDuplicates",i),this.results=i.data.map((t=>{const e={...t,biddingFileName:decodeURIComponent(t.biddingFileName),targetFileName:decodeURIComponent(t.targetFileName),repetitionRate:`${100*parseFloat(t.abstract.repetitionRate)||0}`.substring(0,5)+"%",sameImage:`${t.abstract.imageRepetitionCount}/${t.abstract.imageTotal}`,sameSentence:`${t.abstract.textRepetitionCount}/${t.abstract.textTotal}`};return e}))},handleResultClick(t){console.log("handleResultClick",t),this.$router.push({path:"/pdf-preview",query:{compireId:t._id}})},handleEdit(){this.mode="edit"},handleSave(){this.mode="detail",(0,n.iE)(this.id,this.metaInfo)},async exportPdf(){this.showPreview=!1,await new Promise(((t,e)=>{setTimeout((()=>{t()}),100)}));const t=document.querySelector(".pdf-export-main-con"),e=document.querySelector(".bottom-con"),i=e.style.display;e.style.display="none",t.style.overflowY="visible",t.style.height="auto";const a=await o()(t,{windowHeight:t.scrollHeight,windowWidth:t.scrollWidth}),n=a.toDataURL("image/png");e.style.display=i;const s=.264583*t.scrollWidth,l=.264583*t.scrollHeight;t.style.overflowY="auto",t.style.height="calc(100% - 120px)";const c=new r.ZP({orientation:l>s?"portrait":"landscape",unit:"mm",format:[s,l]});this.showPreview=!0,c.addImage(n,"PNG",0,0,s,l),c.save("report.pdf")}}},a()}catch(c){a(c)}}))},6230:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{i(560);var n=i(3219),s=t([n]);n=(s.then?(await s)():s)[0],e.Z={name:"ReportDetail",components:{},data(){return{value1:"",reports:[],pagination:{page:1,pageSize:10,total:0},selectedRow:[],filters:{projectName:"",biddingNumber:"",biddingCompany:"",participatingCompany:"",participateCompany:"",startTime:"",endTime:""}}},mounted(){console.log(this.$route.query),this.getReports()},methods:{changeDate(){this.filters.startTime=this.value1&&this.value1[0],this.filters.endTime=this.value1&&this.value1[1]},goDetail(t){this.$router.push({path:"/report-detail",query:{id:t._id}})},async getReports(t=1){console.log("test");const{pageSize:e}=this.pagination;this.pagination.page=t,this.filters.page=t,this.filters.pageSize=e;const i=await(0,n._8)(this.filters);console.log(i.data),this.pagination.total=i.total,this.reports=i.data.map((t=>{let e={};return e=t.metaInfo?{...t,...t.metaInfo}:{...t,projectName:"",biddingNumber:"",biddingCompany:"",time:""},e.results=t.results?t.results.length:0,console.log(e),e}))},async deleteReport(t){this.$confirm("此操作将永久删除该报告, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await(0,n.GR)(t);console.log(e),this.getReports(this.pagination.page),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleSeletionChange(t){console.log("handleSeletionChange",t),this.selectedRow=t},async deleteSelected(){this.$confirm(`此操作将永久删除 ${this.selectedRow.length} 份报告, 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{await this.deleteSelectedReports(),this.$message({type:"success",message:"删除成功!"}),this.getReports(this.pagination.page)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},async deleteSelectedReports(){const t=this.selectedRow.map((t=>t._id));await Promise.all(t.map((t=>(0,n.GR)(t))))}}},a()}catch(o){a(o)}}))},2362:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(3219),s=i(8661),o=t([n]);n=(o.then?(await o)():o)[0],e.Z={name:"TaskList",components:{},data(){return{updateListIntervalId:null,runningTaskList:[],waitingTaskList:[],groupedList:[]}},created(){this.getTaskList(),this.updateListIntervalId=setInterval((()=>{this.getTaskList()}),1e3)},destroyed(){clearInterval(this.updateListIntervalId)},methods:{async getTaskList(){const t=await(0,n.n6)();this.runningTaskList=t.data.running,this.waitingTaskList=t.data.queue;const e={};this.runningTaskList.forEach((t=>{const i=t.batchId;e[i]||(e[i]={...t.reportMetaInfo,createAt:(0,s.formateTime)(t.createAt),total:t.batchTotal,waitting:0,running:0,creator:t.creator},e[i].running+=1)})),this.waitingTaskList.forEach((t=>{const i=t.batchId;e[i]||(e[i]={...t.reportMetaInfo,createAt:(0,s.formateTime)(t.createAt),total:t.batchTotal,waitting:0,running:0,creator:t.creator}),e[i].waitting+=1})),this.groupedList=Object.keys(e).map((t=>({...e[t],batchId:t}))),console.log("groupedList",this.groupedList)},cancelTask(t){(0,n.yF)(t)}}},a()}catch(r){a(r)}}))},4735:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{i(560);var n=i(3219),s=t([n]);n=(s.then?(await s)():s)[0],e.Z={name:"LoginPage",data(){return{username:"",password:""}},mounted(){document.addEventListener("keydown",this.handleKeyDown)},beforeDestroy(){document.removeEventListener("keydown",this.handleKeyDown)},methods:{async handleSubmit(){try{await(0,n.x4)(this.username,this.password),this.$message.success("登录成功"),this.$router.push("/file-upload")}catch(t){this.$message.error(t.response&&t.response.data&&t.response.data.message||t.message),console.error(t)}},handleKeyDown(t){13===t.keyCode&&this.handleSubmit()}}},a()}catch(o){a(o)}}))},7290:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{var n=i(3219),s=t([n]);n=(s.then?(await s)():s)[0],e.Z={name:"UserAdmin",components:{},data(){return{users:[]}},computed:{checkedUsers(){return this.users.filter((t=>t.checked))},isAllCheckedUserEnabled(){return this.checkedUsers.length>0&&this.checkedUsers.every((t=>t.enabled))}},async mounted(){this.init()},methods:{async init(){this.users=[];const t=await(0,n.qs)();this.users=t.data.map((t=>({...t,isEdit:!1,checked:!1})))},async updateUser(t){const e={enabled:t.enabled,name:t.name,password:t.password,username:t.username},i=await(0,n.Nq)(t._id,e);0===i.code?this.$message.success("更新成功"):this.$message.error(i.message),t.isEdit=!1},handleSeletionChange(t){console.log(t),this.users.forEach((e=>{e.checked=t.includes(e)}))},async handleEnableMuti(){const t={enabled:!this.isAllCheckedUserEnabled},e=this.checkedUsers.map((e=>(0,n.Nq)(e._id,t))),i=await Promise.all(e);i.every((t=>0===t.code))?this.$message.success("更新成功"):this.$message.error("更新失败"),this.init()}}},a()}catch(o){a(o)}}))},2592:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});var a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[t.showSidebar?e("Sidebar"):t._e(),e("div",{staticClass:"main-con"},[e("router-view")],1)],1)},n=[]},2517:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});var a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"sidebar"}},[e("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":t.activeIndex},on:{select:t.handleSelect}},[e("el-menu-item",{attrs:{index:"/file-upload"}},[e("template",{slot:"title"},[e("i",{staticClass:"el-icon-folder"}),e("span",[t._v("标书查重 ")])])],2),e("el-menu-item",{attrs:{index:"/task-list"}},[e("i",{staticClass:"el-icon-odometer"}),e("span",[t._v("查重进度")])]),e("el-menu-item",{attrs:{index:"/report-list"}},[e("i",{staticClass:"el-icon-tickets"}),e("span",[t._v("查看报告")])]),"admin"===t.$store.role?e("el-menu-item",{attrs:{index:"/user-admin"}},[e("i",{staticClass:"el-icon-user"}),e("span",[t._v("用户管理")])]):t._e(),e("div",{staticClass:"el-menu-item bottom",on:{click:t.handleLogout}},[e("i",{staticClass:"el-icon-switch-button"}),e("span",[t._v("退出登录")])])],1)],1)},n=[]},6193:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"preview-page"},[e("div",{staticClass:"preview-page-header"},[e("div",{staticClass:"left"},[e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.$router.back()}}},[t._v("返回")])],1),e("div",{staticClass:"right"},[e("el-button",{attrs:{size:"mini"},on:{click:t.handleShowPdf2}},[t._v(t._s(t.showPdf2?"关闭对比文件":"显示对比文件"))]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleExportPdf}},[t._v("导出")])],1)]),e("div",{staticClass:"flex"},[e("div",{ref:"pdfContainer",staticClass:"pdfContainer",attrs:{id:"pdfContainer"}}),t.showPdf2?e("div",{ref:"pdf2Container",staticClass:"pdfContainer",attrs:{id:"pdf2Container"}}):t._e()]),e("div",{staticClass:"res-list",attrs:{id:"right"}},[e("div",{staticClass:"header"},[e("div",{staticClass:"title"},[t._v("重复率")]),e("div",{staticClass:"content"},[t._v(" "+t._s(t.compireResult.abstract.textRepetitionCount)+" / "+t._s(t.compireResult.abstract.textTotal)+" ")])]),t._l(t.MockMatchRes,(function(i,a){return e("div",{key:a,staticClass:"res-item",class:{active:i.id===t.highlightedBlock.id},attrs:{"data-id":i.id},on:{click:function(e){return t.handleResItemClick(i)}}},[e("div",{staticClass:"res-item_title"},[e("div",{staticClass:"index"},[t._v(t._s(i.index+1))]),e("div",{staticClass:"content"},[t._v(" "+t._s(decodeURIComponent(t.compireResult.targetFileName))+" 第"+t._s(i.pdf2Page)+"页 ")]),e("div",{staticClass:"icon"})]),i.id===t.highlightedBlock.id?e("div",{staticClass:"res-item_card"},[e("div",{staticClass:"res-item_card-head"},[t._v("重复内容：")]),"image"===i.type?e("div",[e("img",{attrs:{src:`${t.domain}${i.imgSrc}`,alt:""}})]):e("div",[t._v(" "+t._s(i.text)+" ")])]):t._e()])}))],2)])},n=[]},9943:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"report-preview"},[e("div",{staticClass:"filter"},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.filters}},[e("el-form-item",{attrs:{label:"项目名称："}},[e("el-input",{attrs:{placeholder:"请输入项目名称"},model:{value:t.filters.projectName,callback:function(e){t.$set(t.filters,"projectName",e)},expression:"filters.projectName"}})],1),e("el-form-item",{attrs:{label:"招标编号："}},[e("el-input",{attrs:{placeholder:"请输入招标编号"},model:{value:t.filters.biddingNumber,callback:function(e){t.$set(t.filters,"biddingNumber",e)},expression:"filters.biddingNumber"}})],1),e("el-form-item",{attrs:{label:"招标单位："}},[e("el-input",{attrs:{placeholder:"请输入招标单位"},model:{value:t.filters.biddingCompany,callback:function(e){t.$set(t.filters,"biddingCompany",e)},expression:"filters.biddingCompany"}})],1),e("el-form-item",{attrs:{label:"参与公司："}},[e("el-input",{attrs:{placeholder:"请输入参与公司"},model:{value:t.filters.participatingCompany,callback:function(e){t.$set(t.filters,"participatingCompany",e)},expression:"filters.participatingCompany"}})],1),e("el-form-item",{attrs:{label:"选择时间："}},[e("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},on:{change:t.changeDate},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}})],1),e("el-form-item",[e("el-button",{on:{click:()=>{t.filters={},t.getReports()}}},[t._v("重置")]),e("el-button",{attrs:{type:"primary"},on:{click:t.getReports}},[t._v("查询")]),t.selectedRow.length?e("el-button",{attrs:{type:"danger"},on:{click:t.deleteSelected}},[t._v("删除选中项目")]):t._e()],1)],1)],1),e("div",{staticClass:"report-list"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.reports,border:""},on:{"selection-change":t.handleSeletionChange}},[e("el-table-column",{attrs:{type:"selection",align:"center","class-name":"felxc",width:"50"}}),e("el-table-column",{attrs:{align:"center",prop:"projectName",label:"项目名称",width:"180"}}),e("el-table-column",{attrs:{align:"center",prop:"biddingNumber",label:"招标编号",width:"180"}}),e("el-table-column",{attrs:{align:"center",prop:"biddingCompany",label:"招标单位"}}),e("el-table-column",{attrs:{align:"center",prop:"time",label:"时间"}}),e("el-table-column",{attrs:{align:"center",prop:"results",label:"文件数量"}}),e("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.goDetail(i.row)}}},[t._v("查看")]),e("el-button",{staticClass:"danger-text-button",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.deleteReport(i.row._id)}}},[t._v("删除")])]}}])})],1),e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{layout:"prev, pager, next, jumper",total:t.pagination.total,"page-size":t.pagination.pageSize,"current-page":t.pagination.page},on:{"current-change":t.getReports}})],1)],1)])},n=[]},7471:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});var a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"login-page"}},[e("div",{staticClass:"login-con"},[e("div",{staticClass:"banner"}),e("div",{staticClass:"login-from"},[e("div",{staticClass:"title"},[t._v("用户登录")]),e("div",{staticClass:"input-con"},[e("el-input",{attrs:{type:"text",placeholder:"请输入用户名"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSubmit.apply(null,arguments)}},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}},[e("i",{staticClass:"el-input__icon el-icon-user",attrs:{slot:"prefix"},slot:"prefix"})])],1),e("div",{staticClass:"input-con"},[e("el-input",{attrs:{type:"password",placeholder:"请输入密码"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSubmit.apply(null,arguments)}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[e("i",{staticClass:"el-input__icon el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),e("div",{staticClass:"btn-con"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("登录")])],1)])])])},n=[]},7567:function(t,e,i){"use strict";i.d(e,{s:function(){return a},x:function(){return n}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-admin"},[e("div",{staticClass:"user-admin-header"},[t._v("用户管理")]),e("div",{staticClass:"user-list"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.users},on:{"selection-change":t.handleSeletionChange}},[e("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),e("el-table-column",{attrs:{prop:"name",align:"center",label:"姓名"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.isEdit?e("div",[e("el-input",{attrs:{type:"text",placeholder:"请输入姓名"},model:{value:i.row.name,callback:function(e){t.$set(i.row,"name",e)},expression:"scope.row.name"}},[e("i",{staticClass:"el-input__icon el-icon-user",attrs:{slot:"prefix"},slot:"prefix"})])],1):e("div",[t._v(t._s(i.row.name))])]}}])}),e("el-table-column",{attrs:{prop:"username",align:"center",label:"登录账号"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.isEdit?e("div",[e("el-input",{attrs:{type:"text",placeholder:"请输入登录账号"},model:{value:i.row.username,callback:function(e){t.$set(i.row,"username",e)},expression:"scope.row.username"}},[e("i",{staticClass:"el-input__icon el-icon-user",attrs:{slot:"prefix"},slot:"prefix"})])],1):e("div",[t._v(t._s(i.row.username))])]}}])}),e("el-table-column",{attrs:{prop:"password",align:"center",label:"密码"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.isEdit?e("div",[e("el-input",{attrs:{type:"text",placeholder:"请输入密码"},model:{value:i.row.password,callback:function(e){t.$set(i.row,"password",e)},expression:"scope.row.password"}},[e("i",{staticClass:"el-input__icon el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1):e("div",[t._v(t._s(i.row.password))])]}}])}),e("el-table-column",{attrs:{prop:"enabled",align:"center",label:"授权"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{class:i.row.enabled?"accredit green":"accredit red"},[t._v(" "+t._s(i.row.enabled?"已授权":"未授权")+" ")])]}}])}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.isEdit?t._e():e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){i.row.isEdit=!0}}},[t._v(" 编辑 ")]),i.row.isEdit?e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){i.row.isEdit=!1}}},[t._v(" 取消 ")]):t._e(),i.row.isEdit?e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.updateUser(i.row)}}},[t._v(" 保存 ")]):t._e()]}}])})],1)],1),e("div",{staticClass:"user-admin-bottom"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleEnableMuti}},[t._v(t._s(t.isAllCheckedUserEnabled?"取消授权选中账号":"授权选中账号"))])],1)])},n=[]},3219:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{i.d(e,{AH:function(){return C},DH:function(){return m},GR:function(){return y},Nq:function(){return $},Rf:function(){return k},VB:function(){return f},Zn:function(){return w},_8:function(){return v},cT:function(){return b},gp:function(){return h},iE:function(){return g},kS:function(){return u},n6:function(){return _},qs:function(){return I},x4:function(){return x},yF:function(){return S}});var n=i(1076),s=i(7849),o=i(866),r=t([o]);o=(r.then?(await r)():r)[0];const c=n.Z.create({baseURL:s.y,timeout:3e5}),d=t=>{console.log("setLoginInfo",t),o.h.isLoggedIn=!0,o.h.username=t.username,o.h.role=t.role,o.h.token=t.token,localStorage.setItem("loginInfo",JSON.stringify(t))},u=()=>{o.h.isLoggedIn=!1,o.h.username="",o.h.role="",o.h.token="",localStorage.removeItem("loginInfo")};async function p(t){const e=o.h.token;e?c.defaults.headers.common["Authorization"]=e:(delete c.defaults.headers.common["Authorization"],window.location.href="#/login");let i={};try{i=await t()}catch(a){401===a.response.status&&(window.location.href="#/login",u(),window.vueInstance.$message.error("登录信息已过期，请重新登录"))}return i.data}const h=async t=>await p((()=>c.get(`api/v1/duplicate/report/${t}`))),f=async t=>await p((()=>c.post("api/v1/duplicate/get-duplicates",{duplicateIds:t}))),m=async t=>await p((()=>c.get(`api/v1/duplicate/duplicate-result/${t}`))),g=async(t,e)=>await p((()=>c.post("api/v1/duplicate/update-report",{id:t,metaInfo:e}))),v=async t=>await p((()=>c.get("api/v1/duplicate/reports",{params:t}))),y=async t=>await p((()=>c.post("api/v1/duplicate/delete-report",{id:t}))),b=async(t,e)=>await p((()=>c.post("api/v1/file/upload",t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:t=>{const{loaded:i,total:a}=t,n=Math.floor(100*i/a);e(n)}}))),w=async t=>await p((()=>c.post("api/v1/duplicate/create-report",{results:t}))),k=async t=>await p((()=>c.post("api/v1/duplicate/exec-duplicate",t,{timeout:12e5}))),C=async(t,e={})=>await p((()=>c.post("api/v1/duplicate/create-duplicate-task",{taskList:t,reportMetaInfo:e}))),_=async()=>await p((()=>c.get("api/v1/duplicate/current-tasks"))),x=async(t,e)=>{const i=await c.post("api/v1/user/login",{username:t,password:e});0===i.data.code?d(i.data.data):console.error(i.data.message)},I=async()=>await p((()=>c.get("api/v1/user/users"))),$=async(t,e)=>await p((()=>c.post("api/v1/user/update-user",{userId:t,info:e}))),S=async t=>await p((()=>c.post("api/v1/duplicate/cancel-batch-duplicate-task",{batchId:t})));a()}catch(l){a(l)}}))},866:function(t,e,i){"use strict";i.a(t,(async function(t,a){try{i.d(e,{h:function(){return v}});var n=i(6369),s=i(2631),o=i(2275),r=i(8902),l=i(8696),c=i(8572),d=i(7514),u=i(8499),p=i.n(u),h=i(9847),f=i(5816),m=i(5881),g=t([o,r,l,c,d,h,f,m]);[o,r,l,c,d,h,f,m]=g.then?(await g)():g;const v=n["default"].observable({isLoggedIn:!1,username:"",token:"",role:"",name:""});if(localStorage.getItem("loginInfo")){const t=JSON.parse(localStorage.getItem("loginInfo"));v.isLoggedIn=!0,v.username=t.username,v.role=t.role,v.token=t.token,v.name=t.name}n["default"].use(s.ZP),n["default"].use(p()),n["default"].prototype.$store=v,window.vueStore=v;const y=[{path:"/",redirect:"/login",name:"login"},{path:"/login",component:h.Z,name:"login"},{path:"/user-admin",component:f.Z,name:"userAdmin"},{path:"/task-list",component:m.Z},{path:"/pdf-preview",component:r.Z,name:"pdf-preview"},{path:"/report-list",component:d.Z},{path:"/file-upload",component:l.Z},{path:"/report-detail",component:c.Z}],b=new s.ZP({routes:y}),w=new n["default"]({router:b,render:t=>t(o.Z)}).$mount("#app");console.log(w),window.vueInstance=w,a()}catch(v){a(v)}}))},8661:function(t){const e=t=>{const e=new Date(t);return`${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}`};t.exports={formateTime:e}},5989:function(t,e,i){"use strict";t.exports=i.p+"img/icon.1294d74a.webp"}},e={};function i(a){var n=e[a];if(void 0!==n)return n.exports;var s=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.m=t,function(){i.amdO={}}(),function(){var t="function"===typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"===typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",a="function"===typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=function(t){t&&t.d<1&&(t.d=1,t.forEach((function(t){t.r--})),t.forEach((function(t){t.r--?t.r++:t()})))},s=function(i){return i.map((function(i){if(null!==i&&"object"===typeof i){if(i[t])return i;if(i.then){var s=[];s.d=0,i.then((function(t){o[e]=t,n(s)}),(function(t){o[a]=t,n(s)}));var o={};return o[t]=function(t){t(s)},o}}var r={};return r[t]=function(){},r[e]=i,r}))};i.a=function(i,o,r){var l;r&&((l=[]).d=-1);var c,d,u,p=new Set,h=i.exports,f=new Promise((function(t,e){u=e,d=t}));f[e]=h,f[t]=function(t){l&&t(l),p.forEach(t),f["catch"]((function(){}))},i.exports=f,o((function(i){var n;c=s(i);var o=function(){return c.map((function(t){if(t[a])throw t[a];return t[e]}))},r=new Promise((function(e){n=function(){e(o)},n.r=0;var i=function(t){t!==l&&!p.has(t)&&(p.add(t),t&&!t.d&&(n.r++,t.push(n)))};c.map((function(e){e[t](i)}))}));return n.r?r:o()}),(function(t){t?u(f[a]=t):d(h),n(l)})),l&&l.d<0&&(l.d=0)}}(),function(){var t=[];i.O=function(e,a,n,s){if(!a){var o=1/0;for(d=0;d<t.length;d++){a=t[d][0],n=t[d][1],s=t[d][2];for(var r=!0,l=0;l<a.length;l++)(!1&s||o>=s)&&Object.keys(i.O).every((function(t){return i.O[t](a[l])}))?a.splice(l--,1):(r=!1,s<o&&(o=s));if(r){t.splice(d--,1);var c=n();void 0!==c&&(e=c)}}return e}s=s||0;for(var d=t.length;d>0&&t[d-1][2]>s;d--)t[d]=t[d-1];t[d]=[a,n,s]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){var t,e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__};i.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var s=Object.create(null);i.r(s);var o={};t=t||[null,e({}),e([]),e(e)];for(var r=2&n&&a;"object"==typeof r&&!~t.indexOf(r);r=e(r))Object.getOwnPropertyNames(r).forEach((function(t){o[t]=function(){return a[t]}}));return o["default"]=function(){return a},i.d(s,o),s}}(),function(){i.d=function(t,e){for(var a in e)i.o(e,a)&&!i.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){i.f={},i.e=function(t){return Promise.all(Object.keys(i.f).reduce((function(e,a){return i.f[a](t,e),e}),[]))}}(),function(){i.u=function(t){return"js/"+t+"."+{1:"1d2a4b69",128:"95654e34",172:"6c2f742d",296:"10f439f4",414:"ef937939",558:"cb6ad082",617:"62f042cd",779:"69e27e43"}[t]+".js"}}(),function(){i.miniCssF=function(t){}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="paper-match-frontend:";i.l=function(a,n,s,o){if(t[a])t[a].push(n);else{var r,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==e+s){r=u;break}}r||(l=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,i.nc&&r.setAttribute("nonce",i.nc),r.setAttribute("data-webpack",e+s),r.src=a),t[a]=[n];var p=function(e,i){r.onerror=r.onload=null,clearTimeout(h);var n=t[a];if(delete t[a],r.parentNode&&r.parentNode.removeChild(r),n&&n.forEach((function(t){return t(i)})),e)return e(i)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),l&&document.head.appendChild(r)}}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){i.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){i.p=""}(),function(){var t={143:0};i.f.j=function(e,a){var n=i.o(t,e)?t[e]:void 0;if(0!==n)if(n)a.push(n[2]);else{var s=new Promise((function(i,a){n=t[e]=[i,a]}));a.push(n[2]=s);var o=i.p+i.u(e),r=new Error,l=function(a){if(i.o(t,e)&&(n=t[e],0!==n&&(t[e]=void 0),n)){var s=a&&("load"===a.type?"missing":a.type),o=a&&a.target&&a.target.src;r.message="Loading chunk "+e+" failed.\n("+s+": "+o+")",r.name="ChunkLoadError",r.type=s,r.request=o,n[1](r)}};i.l(o,l,"chunk-"+e,e)}},i.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,s,o=a[0],r=a[1],l=a[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(l)var d=l(i)}for(e&&e(a);c<o.length;c++)s=o[c],i.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return i.O(d)},a=self["webpackChunkpaper_match_frontend"]=self["webpackChunkpaper_match_frontend"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=i.O(void 0,[998],(function(){return i(866)}));a=i.O(a)})();
//# sourceMappingURL=app.b7e9c52e.js.map